(function(n){function i(n,t){for(var i=window,r=(n||"").split(".");i&&r.length;)i=i[r.shift()];return typeof i=="function"?i:(t.push(n),Function.constructor.apply(null,t))}function u(n){return n==="GET"||n==="POST"}function o(n,t){u(t)||n.setRequestHeader("X-HTTP-Method-Override",t)}function s(t,i,r){var u;r.indexOf("application/x-javascript")===-1&&(u=(t.getAttribute("data-ajax-mode")||"").toUpperCase(),n(t.getAttribute("data-ajax-update")).each(function(t,r){var f;switch(u){case"BEFORE":f=r.firstChild,n("<div />").html(i).contents().each(function(){r.insertBefore(this,f)});break;case"AFTER":n("<div />").html(i).contents().each(function(){r.appendChild(this)});break;case"REPLACE-WITH":n(r).replaceWith(i);break;default:n(r).html(i)}}))}function f(t,r){var e,h,f,c;(e=t.getAttribute("data-ajax-confirm"),!e||window.confirm(e))&&(h=n(t.getAttribute("data-ajax-loading")),c=parseInt(t.getAttribute("data-ajax-loading-duration"),10)||0,n.extend(r,{type:t.getAttribute("data-ajax-method")||undefined,url:t.getAttribute("data-ajax-url")||undefined,cache:!!t.getAttribute("data-ajax-cache"),beforeSend:function(n){var r;return o(n,f),r=i(t.getAttribute("data-ajax-begin"),["xhr"]).apply(t,arguments),r!==!1&&h.show(c),r},complete:function(){h.hide(c),i(t.getAttribute("data-ajax-complete"),["xhr","status"]).apply(t,arguments)},success:function(n,r,u){s(t,n,u.getResponseHeader("Content-Type")||"text/html"),i(t.getAttribute("data-ajax-success"),["data","status","xhr"]).apply(t,arguments)},error:function(){i(t.getAttribute("data-ajax-failure"),["xhr","status","error"]).apply(t,arguments)}}),r.data.push({name:"X-Requested-With",value:"XMLHttpRequest"}),f=r.type.toUpperCase(),u(f)||(r.type="POST",r.data.push({name:"X-HTTP-Method-Override",value:f})),n.ajax(r))}function h(t){var i=n(t).data(e);return!i||!i.validate||i.validate()}var t="unobtrusiveAjaxClick",r="unobtrusiveAjaxClickTarget",e="unobtrusiveValidation";n(document).on("click","a[data-ajax=true]",function(n){n.preventDefault(),f(this,{url:this.href,type:"GET",data:[]})});n(document).on("click","form[data-ajax=true] input[type=image]",function(i){var r=i.target.name,u=n(i.target),f=n(u.parents("form")[0]),e=u.offset();f.data(t,[{name:r+".x",value:Math.round(i.pageX-e.left)},{name:r+".y",value:Math.round(i.pageY-e.top)}]),setTimeout(function(){f.removeData(t)},0)});n(document).on("click","form[data-ajax=true] :submit",function(i){var f=i.currentTarget.name,e=n(i.target),u=n(e.parents("form")[0]);u.data(t,f?[{name:f,value:i.currentTarget.value}]:[]),u.data(r,e),setTimeout(function(){u.removeData(t),u.removeData(r)},0)});n(document).on("submit","form[data-ajax=true]",function(i){var e=n(this).data(t)||[],u=n(this).data(r),o=u&&u.hasClass("cancel");(i.preventDefault(),o||h(this))&&f(this,{url:this.action,type:this.method||"GET",data:e.concat(n(this).serializeArray())})})})(jQuery);/*! jQuery Validation Plugin - v1.11.1 - 3/22/2013\n* https://github.com/jzaefferer/jquery-validation
* Copyright (c) 2013 JÃ¶rn Zaefferer; Licensed MIT */
(function(n){n.extend(n.fn,{validate:function(t){if(!this.length)return t&&t.debug&&window.console&&console.warn("Nothing selected, can't validate, returning nothing."),void 0;var i=n.data(this[0],"validator");return i?i:(this.attr("novalidate","novalidate"),i=new n.validator(t,this[0]),n.data(this[0],"validator",i),i.settings.onsubmit&&(this.validateDelegate(":submit","click",function(t){i.settings.submitHandler&&(i.submitButton=t.target),n(t.target).hasClass("cancel")&&(i.cancelSubmit=!0),void 0!==n(t.target).attr("formnovalidate")&&(i.cancelSubmit=!0)}),this.submit(function(t){function r(){var r;return i.settings.submitHandler?(i.submitButton&&(r=n("<input type='hidden'/>").attr("name",i.submitButton.name).val(n(i.submitButton).val()).appendTo(i.currentForm)),i.settings.submitHandler.call(i,i.currentForm,t),i.submitButton&&r.remove(),!1):!0}return i.settings.debug&&t.preventDefault(),i.cancelSubmit?(i.cancelSubmit=!1,r()):i.form()?i.pendingRequest?(i.formSubmitted=!0,!1):r():(i.focusInvalid(),!1)})),i)},valid:function(){if(n(this[0]).is("form"))return this.validate().form();var t=!0,i=n(this[0].form).validate();return this.each(function(){t=t&&i.element(this)}),t},removeAttrs:function(t){var i={},r=this;return n.each(t.split(/\s/),function(n,t){i[t]=r.attr(t),r.removeAttr(t)}),i},rules:function(t,i){var r=this[0],o,u,h;if(t){var e=n.data(r.form,"validator").settings,s=e.rules,f=n.validator.staticRules(r);switch(t){case"add":n.extend(f,n.validator.normalizeRule(i)),delete f.messages,s[r.name]=f,i.messages&&(e.messages[r.name]=n.extend(e.messages[r.name],i.messages));break;case"remove":return i?(o={},n.each(i.split(/\s/),function(n,t){o[t]=f[t],delete f[t]}),o):(delete s[r.name],f)}}return u=n.validator.normalizeRules(n.extend({},n.validator.classRules(r),n.validator.attributeRules(r),n.validator.dataRules(r),n.validator.staticRules(r)),r),u.required&&(h=u.required,delete u.required,u=n.extend({required:h},u)),u}}),n.extend(n.expr[":"],{blank:function(t){return!n.trim(""+n(t).val())},filled:function(t){return!!n.trim(""+n(t).val())},unchecked:function(t){return!n(t).prop("checked")}}),n.validator=function(t,i){this.settings=n.extend(!0,{},n.validator.defaults,t),this.currentForm=i,this.init()},n.validator.format=function(t,i){return 1===arguments.length?function(){var i=n.makeArray(arguments);return i.unshift(t),n.validator.format.apply(this,i)}:(arguments.length>2&&i.constructor!==Array&&(i=n.makeArray(arguments).slice(1)),i.constructor!==Array&&(i=[i]),n.each(i,function(n,i){t=t.replace(RegExp("\\{"+n+"\\}","g"),function(){return i})}),t)},n.extend(n.validator,{defaults:{messages:{},groups:{},rules:{},errorClass:"error",validClass:"valid",errorElement:"label",focusInvalid:!0,errorContainer:n([]),errorLabelContainer:n([]),onsubmit:!0,ignore:":hidden",ignoreTitle:!1,onfocusin:function(n){this.lastActive=n,this.settings.focusCleanup&&!this.blockFocusCleanup&&(this.settings.unhighlight&&this.settings.unhighlight.call(this,n,this.settings.errorClass,this.settings.validClass),this.addWrapper(this.errorsFor(n)).hide())},onfocusout:function(n){!this.checkable(n)&&(n.name in this.submitted||!this.optional(n))&&this.element(n)},onkeyup:function(n,t){(9!==t.which||""!==this.elementValue(n))&&(n.name in this.submitted||n===this.lastElement)&&this.element(n)},onclick:function(n){n.name in this.submitted?this.element(n):n.parentNode.name in this.submitted&&this.element(n.parentNode)},highlight:function(t,i,r){"radio"===t.type?this.findByName(t.name).addClass(i).removeClass(r):n(t).addClass(i).removeClass(r)},unhighlight:function(t,i,r){"radio"===t.type?this.findByName(t.name).removeClass(i).addClass(r):n(t).removeClass(i).addClass(r)}},setDefaults:function(t){n.extend(n.validator.defaults,t)},messages:{required:"This field is required.",remote:"Please fix this field.",email:"Please enter a valid email address.",url:"Please enter a valid URL.",date:"Please enter a valid date.",dateISO:"Please enter a valid date (ISO).",number:"Please enter a valid number.",digits:"Please enter only digits.",creditcard:"Please enter a valid credit card number.",equalTo:"Please enter the same value again.",maxlength:n.validator.format("Please enter no more than {0} characters."),minlength:n.validator.format("Please enter at least {0} characters."),rangelength:n.validator.format("Please enter a value between {0} and {1} characters long."),range:n.validator.format("Please enter a value between {0} and {1}."),max:n.validator.format("Please enter a value less than or equal to {0}."),min:n.validator.format("Please enter a value greater than or equal to {0}.")},autoCreateRanges:!1,prototype:{init:function(){function r(t){var i=n.data(this[0].form,"validator"),r="on"+t.type.replace(/^validate/,"");i.settings[r]&&i.settings[r].call(i,this[0],t)}var i,t;this.labelContainer=n(this.settings.errorLabelContainer),this.errorContext=this.labelContainer.length&&this.labelContainer||n(this.currentForm),this.containers=n(this.settings.errorContainer).add(this.settings.errorLabelContainer),this.submitted={},this.valueCache={},this.pendingRequest=0,this.pending={},this.invalid={},this.reset(),i=this.groups={},n.each(this.settings.groups,function(t,r){"string"==typeof r&&(r=r.split(/\s/)),n.each(r,function(n,r){i[r]=t})}),t=this.settings.rules,n.each(t,function(i,r){t[i]=n.validator.normalizeRule(r)}),n(this.currentForm).validateDelegate(":text, [type='password'], [type='file'], select, textarea, [type='number'], [type='search'] ,[type='tel'], [type='url'], [type='email'], [type='datetime'], [type='date'], [type='month'], [type='week'], [type='time'], [type='datetime-local'], [type='range'], [type='color'] ","focusin focusout keyup",r).validateDelegate("[type='radio'], [type='checkbox'], select, option","click",r),this.settings.invalidHandler&&n(this.currentForm).bind("invalid-form.validate",this.settings.invalidHandler)},form:function(){return this.checkForm(),n.extend(this.submitted,this.errorMap),this.invalid=n.extend({},this.errorMap),this.valid()||n(this.currentForm).triggerHandler("invalid-form",[this]),this.showErrors(),this.valid()},checkForm:function(){this.prepareForm();for(var n=0,t=this.currentElements=this.elements();t[n];n++)this.check(t[n]);return this.valid()},element:function(t){t=this.validationTargetFor(this.clean(t)),this.lastElement=t,this.prepareElement(t),this.currentElements=n(t);var i=this.check(t)!==!1;return i?delete this.invalid[t.name]:this.invalid[t.name]=!0,this.numberOfInvalids()||(this.toHide=this.toHide.add(this.containers)),this.showErrors(),i},showErrors:function(t){if(t){n.extend(this.errorMap,t),this.errorList=[];for(var i in t)this.errorList.push({message:t[i],element:this.findByName(i)[0]});this.successList=n.grep(this.successList,function(n){return!(n.name in t)})}this.settings.showErrors?this.settings.showErrors.call(this,this.errorMap,this.errorList):this.defaultShowErrors()},resetForm:function(){n.fn.resetForm&&n(this.currentForm).resetForm(),this.submitted={},this.lastElement=null,this.prepareForm(),this.hideErrors(),this.elements().removeClass(this.settings.errorClass).removeData("previousValue")},numberOfInvalids:function(){return this.objectLength(this.invalid)},objectLength:function(n){var t=0,i;for(i in n)t++;return t},hideErrors:function(){this.addWrapper(this.toHide).hide()},valid:function(){return 0===this.size()},size:function(){return this.errorList.length},focusInvalid:function(){if(this.settings.focusInvalid)try{n(this.findLastActive()||this.errorList.length&&this.errorList[0].element||[]).filter(":visible").focus().trigger("focusin")}catch(t){}},findLastActive:function(){var t=this.lastActive;return t&&1===n.grep(this.errorList,function(n){return n.element.name===t.name}).length&&t},elements:function(){var t=this,i={};return n(this.currentForm).find("input, select, textarea").not(":submit, :reset, :image, [disabled]").not(this.settings.ignore).filter(function(){return!this.name&&t.settings.debug&&window.console&&console.error("%o has no name assigned",this),this.name in i||!t.objectLength(n(this).rules())?!1:(i[this.name]=!0,!0)})},clean:function(t){return n(t)[0]},errors:function(){var t=this.settings.errorClass.replace(" ",".");return n(this.settings.errorElement+"."+t,this.errorContext)},reset:function(){this.successList=[],this.errorList=[],this.errorMap={},this.toShow=n([]),this.toHide=n([]),this.currentElements=n([])},prepareForm:function(){this.reset(),this.toHide=this.errors().add(this.containers)},prepareElement:function(n){this.reset(),this.toHide=this.errorsFor(n)},elementValue:function(t){var r=n(t).attr("type"),i=n(t).val();return"radio"===r||"checkbox"===r?n("input[name='"+n(t).attr("name")+"']:checked").val():"string"==typeof i?i.replace(/\r/g,""):i},check:function(t){var r,u;t=this.validationTargetFor(this.clean(t));var i,f=n(t).rules(),e=!1,o=this.elementValue(t);for(r in f){u={method:r,parameters:f[r]};try{if(i=n.validator.methods[r].call(this,o,t,u.parameters),"dependency-mismatch"===i){e=!0;continue}if(e=!1,"pending"===i)return this.toHide=this.toHide.not(this.errorsFor(t)),void 0;if(!i)return this.formatAndAdd(t,u),!1}catch(s){throw this.settings.debug&&window.console&&console.log("Exception occurred when checking element "+t.id+", check the '"+u.method+"' method.",s),s;}}if(!e)return this.objectLength(f)&&this.successList.push(t),!0},customDataMessage:function(t,i){return n(t).data("msg-"+i.toLowerCase())||t.attributes&&n(t).attr("data-msg-"+i.toLowerCase())},customMessage:function(n,t){var i=this.settings.messages[n];return i&&(i.constructor===String?i:i[t])},findDefined:function(){for(var n=0;arguments.length>n;n++)if(void 0!==arguments[n])return arguments[n];return void 0},defaultMessage:function(t,i){return this.findDefined(this.customMessage(t.name,i),this.customDataMessage(t,i),!this.settings.ignoreTitle&&t.title||void 0,n.validator.messages[i],"<strong>Warning: No message defined for "+t.name+"</strong>")},formatAndAdd:function(t,i){var r=this.defaultMessage(t,i.method),u=/\$?\{(\d+)\}/g;"function"==typeof r?r=r.call(this,i.parameters,t):u.test(r)&&(r=n.validator.format(r.replace(u,"{$1}"),i.parameters)),this.errorList.push({message:r,element:t}),this.errorMap[t.name]=r,this.submitted[t.name]=r},addWrapper:function(n){return this.settings.wrapper&&(n=n.add(n.parent(this.settings.wrapper))),n},defaultShowErrors:function(){for(var i,t,n=0;this.errorList[n];n++)t=this.errorList[n],this.settings.highlight&&this.settings.highlight.call(this,t.element,this.settings.errorClass,this.settings.validClass),this.showLabel(t.element,t.message);if(this.errorList.length&&(this.toShow=this.toShow.add(this.containers)),this.settings.success)for(n=0;this.successList[n];n++)this.showLabel(this.successList[n]);if(this.settings.unhighlight)for(n=0,i=this.validElements();i[n];n++)this.settings.unhighlight.call(this,i[n],this.settings.errorClass,this.settings.validClass);this.toHide=this.toHide.not(this.toShow),this.hideErrors(),this.addWrapper(this.toShow).show()},validElements:function(){return this.currentElements.not(this.invalidElements())},invalidElements:function(){return n(this.errorList).map(function(){return this.element})},showLabel:function(t,i){var r=this.errorsFor(t);r.length?(r.removeClass(this.settings.validClass).addClass(this.settings.errorClass),r.html(i)):(r=n("<"+this.settings.errorElement+">").attr("for",this.idOrName(t)).addClass(this.settings.errorClass).html(i||""),this.settings.wrapper&&(r=r.hide().show().wrap("<"+this.settings.wrapper+"/>").parent()),this.labelContainer.append(r).length||(this.settings.errorPlacement?this.settings.errorPlacement(r,n(t)):r.insertAfter(t))),!i&&this.settings.success&&(r.text(""),"string"==typeof this.settings.success?r.addClass(this.settings.success):this.settings.success(r,t)),this.toShow=this.toShow.add(r)},errorsFor:function(t){var i=this.idOrName(t);return this.errors().filter(function(){return n(this).attr("for")===i})},idOrName:function(n){return this.groups[n.name]||(this.checkable(n)?n.name:n.id||n.name)},validationTargetFor:function(n){return this.checkable(n)&&(n=this.findByName(n.name).not(this.settings.ignore)[0]),n},checkable:function(n){return/radio|checkbox/i.test(n.type)},findByName:function(t){return n(this.currentForm).find("[name='"+t+"']")},getLength:function(t,i){switch(i.nodeName.toLowerCase()){case"select":return n("option:selected",i).length;case"input":if(this.checkable(i))return this.findByName(i.name).filter(":checked").length}return t.length},depend:function(n,t){return this.dependTypes[typeof n]?this.dependTypes[typeof n](n,t):!0},dependTypes:{boolean:function(n){return n},string:function(t,i){return!!n(t,i.form).length},"function":function(n,t){return n(t)}},optional:function(t){var i=this.elementValue(t);return!n.validator.methods.required.call(this,i,t)&&"dependency-mismatch"},startRequest:function(n){this.pending[n.name]||(this.pendingRequest++,this.pending[n.name]=!0)},stopRequest:function(t,i){this.pendingRequest--,0>this.pendingRequest&&(this.pendingRequest=0),delete this.pending[t.name],i&&0===this.pendingRequest&&this.formSubmitted&&this.form()?(n(this.currentForm).submit(),this.formSubmitted=!1):!i&&0===this.pendingRequest&&this.formSubmitted&&(n(this.currentForm).triggerHandler("invalid-form",[this]),this.formSubmitted=!1)},previousValue:function(t){return n.data(t,"previousValue")||n.data(t,"previousValue",{old:null,valid:!0,message:this.defaultMessage(t,"remote")})}},classRuleSettings:{required:{required:!0},email:{email:!0},url:{url:!0},date:{date:!0},dateISO:{dateISO:!0},number:{number:!0},digits:{digits:!0},creditcard:{creditcard:!0}},addClassRules:function(t,i){t.constructor===String?this.classRuleSettings[t]=i:n.extend(this.classRuleSettings,t)},classRules:function(t){var i={},r=n(t).attr("class");return r&&n.each(r.split(" "),function(){this in n.validator.classRuleSettings&&n.extend(i,n.validator.classRuleSettings[this])}),i},attributeRules:function(t){var u={},e=n(t),f=e[0].getAttribute("type"),r,i;for(r in n.validator.methods)"required"===r?(i=e.get(0).getAttribute(r),""===i&&(i=!0),i=!!i):i=e.attr(r),/min|max/.test(r)&&(null===f||/number|range|text/.test(f))&&(i=Number(i)),i?u[r]=i:f===r&&"range"!==f&&(u[r]=!0);return u.maxlength&&/-1|2147483647|524288/.test(u.maxlength)&&delete u.maxlength,u},dataRules:function(t){var i,r,u={},f=n(t);for(i in n.validator.methods)r=f.data("rule-"+i.toLowerCase()),void 0!==r&&(u[i]=r);return u},staticRules:function(t){var i={},r=n.data(t.form,"validator");return r.settings.rules&&(i=n.validator.normalizeRule(r.settings.rules[t.name])||{}),i},normalizeRules:function(t,i){return n.each(t,function(r,u){if(u===!1)return delete t[r],void 0;if(u.param||u.depends){var f=!0;switch(typeof u.depends){case"string":f=!!n(u.depends,i.form).length;break;case"function":f=u.depends.call(i,i)}f?t[r]=void 0!==u.param?u.param:!0:delete t[r]}}),n.each(t,function(r,u){t[r]=n.isFunction(u)?u(i):u}),n.each(["minlength","maxlength"],function(){t[this]&&(t[this]=Number(t[this]))}),n.each(["rangelength","range"],function(){var i;t[this]&&(n.isArray(t[this])?t[this]=[Number(t[this][0]),Number(t[this][1])]:"string"==typeof t[this]&&(i=t[this].split(/[\s,]+/),t[this]=[Number(i[0]),Number(i[1])]))}),n.validator.autoCreateRanges&&(t.min&&t.max&&(t.range=[t.min,t.max],delete t.min,delete t.max),t.minlength&&t.maxlength&&(t.rangelength=[t.minlength,t.maxlength],delete t.minlength,delete t.maxlength)),t},normalizeRule:function(t){if("string"==typeof t){var i={};n.each(t.split(/\s/),function(){i[this]=!0}),t=i}return t},addMethod:function(t,i,r){n.validator.methods[t]=i,n.validator.messages[t]=void 0!==r?r:n.validator.messages[t],3>i.length&&n.validator.addClassRules(t,n.validator.normalizeRule(t))},methods:{required:function(t,i,r){if(!this.depend(r,i))return"dependency-mismatch";if("select"===i.nodeName.toLowerCase()){var u=n(i).val();return u&&u.length>0}return this.checkable(i)?this.getLength(t,i)>0:n.trim(t).length>0},email:function(n,t){return this.optional(t)||/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(n)},url:function(n,t){return this.optional(t)||/^(https?|s?ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(n)},date:function(n,t){return this.optional(t)||!/Invalid|NaN/.test(""+new Date(n))},dateISO:function(n,t){return this.optional(t)||/^\d{4}[\/\-]\d{1,2}[\/\-]\d{1,2}$/.test(n)},number:function(n,t){return this.optional(t)||/^-?(?:\d+|\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/.test(n)},digits:function(n,t){return this.optional(t)||/^\d+$/.test(n)},creditcard:function(n,t){var r,e;if(this.optional(t))return"dependency-mismatch";if(/[^0-9 \-]+/.test(n))return!1;var f=0,i=0,u=!1;for(n=n.replace(/\D/g,""),r=n.length-1;r>=0;r--)e=n.charAt(r),i=parseInt(e,10),u&&(i*=2)>9&&(i-=9),f+=i,u=!u;return 0==f%10},minlength:function(t,i,r){var u=n.isArray(t)?t.length:this.getLength(n.trim(t),i);return this.optional(i)||u>=r},maxlength:function(t,i,r){var u=n.isArray(t)?t.length:this.getLength(n.trim(t),i);return this.optional(i)||r>=u},rangelength:function(t,i,r){var u=n.isArray(t)?t.length:this.getLength(n.trim(t),i);return this.optional(i)||u>=r[0]&&r[1]>=u},min:function(n,t,i){return this.optional(t)||n>=i},max:function(n,t,i){return this.optional(t)||i>=n},range:function(n,t,i){return this.optional(t)||n>=i[0]&&i[1]>=n},equalTo:function(t,i,r){var u=n(r);return this.settings.onfocusout&&u.unbind(".validate-equalTo").bind("blur.validate-equalTo",function(){n(i).valid()}),t===u.val()},remote:function(t,i,r){var f,u,e;return this.optional(i)?"dependency-mismatch":(f=this.previousValue(i),this.settings.messages[i.name]||(this.settings.messages[i.name]={}),f.originalMessage=this.settings.messages[i.name].remote,this.settings.messages[i.name].remote=f.message,r="string"==typeof r&&{url:r}||r,f.old===t)?f.valid:(f.old=t,u=this,this.startRequest(i),e={},e[i.name]=t,n.ajax(n.extend(!0,{url:r,mode:"abort",port:"validate"+i.name,dataType:"json",data:e,success:function(r){var e,h,s,o;u.settings.messages[i.name].remote=f.originalMessage,e=r===!0||"true"===r,e?(h=u.formSubmitted,u.prepareElement(i),u.formSubmitted=h,u.successList.push(i),delete u.invalid[i.name],u.showErrors()):(s={},o=r||u.defaultMessage(i,"remote"),s[i.name]=f.message=n.isFunction(o)?o(t):o,u.invalid[i.name]=!0,u.showErrors(s)),f.valid=e,u.stopRequest(i,e)}},r)),"pending")}}}),n.format=n.validator.format})(jQuery),function(n){var t={},i;n.ajaxPrefilter?n.ajaxPrefilter(function(n,i,r){var u=n.port;"abort"===n.mode&&(t[u]&&t[u].abort(),t[u]=r)}):(i=n.ajax,n.ajax=function(r){var f=("mode"in r?r:n.ajaxSettings).mode,u=("port"in r?r:n.ajaxSettings).port;return"abort"===f?(t[u]&&t[u].abort(),t[u]=i.apply(this,arguments),t[u]):i.apply(this,arguments)})}(jQuery),function(n){n.extend(n.fn,{validateDelegate:function(t,i,r){return this.bind(i,function(i){var u=n(i.target);if(u.is(t))return r.apply(u,arguments)})}})}(jQuery);(function(n){function i(n,t,i){n.rules[t]=i,n.message&&(n.messages[t]=n.message)}function h(n){return n.replace(/^\s+|\s+$/g,"").split(/\s*,\s*/g)}function f(n){return n.replace(/([!"#$%&'()*+,./:;<=>?@\[\\\]^`{|}~])/g,"\\$1")}function e(n){return n.substr(0,n.lastIndexOf(".")+1)}function o(n,t){return n.indexOf("*.")===0&&(n=n.replace("*.",t)),n}function c(t,i){var r=n(this).find("[data-valmsg-for='"+f(i[0].name)+"']"),u=r.attr("data-valmsg-replace"),e=u?n.parseJSON(u)!==!1:null;r.removeClass("field-validation-valid").addClass("field-validation-error"),t.data("unobtrusiveContainer",r),e?(r.empty(),t.removeClass("input-validation-error").appendTo(r)):t.hide()}function l(t,i){var u=n(this).find("[data-valmsg-summary=true]"),r=u.find("ul");r&&r.length&&i.errorList.length&&(r.empty(),u.addClass("validation-summary-errors").removeClass("validation-summary-valid"),n.each(i.errorList,function(){n("<li />").html(this.message).appendTo(r)}))}function a(t){var i=t.data("unobtrusiveContainer"),r=i.attr("data-valmsg-replace"),u=r?n.parseJSON(r):null;i&&(i.addClass("field-validation-valid").removeClass("field-validation-error"),t.removeData("unobtrusiveContainer"),u&&i.empty())}function v(){var t=n(this),i="__jquery_unobtrusive_validation_form_reset";if(!t.data(i)){t.data(i,!0);try{t.data("validator").resetForm()}finally{t.removeData(i)}t.find(".validation-summary-errors").addClass("validation-summary-valid").removeClass("validation-summary-errors"),t.find(".field-validation-error").addClass("field-validation-valid").removeClass("field-validation-error").removeData("unobtrusiveContainer").find(">*").removeData("unobtrusiveContainer")}}function s(t){var i=n(t),f=i.data(u),s=n.proxy(v,t),e=r.unobtrusive.options||{},o=function(i,r){var u=e[i];u&&n.isFunction(u)&&u.apply(t,r)};return f||(f={options:{errorClass:e.errorClass||"input-validation-error",errorElement:e.errorElement||"span",errorPlacement:function(){c.apply(t,arguments),o("errorPlacement",arguments)},invalidHandler:function(){l.apply(t,arguments),o("invalidHandler",arguments)},messages:{},rules:{},success:function(){a.apply(t,arguments),o("success",arguments)}},attachValidation:function(){i.off("reset."+u,s).on("reset."+u,s).validate(this.options)},validate:function(){return i.validate(),i.valid()}},i.data(u,f)),f}var r=n.validator,t,u="unobtrusiveValidation";r.unobtrusive={adapters:[],parseElement:function(t,i){var u=n(t),f=u.parents("form")[0],r,e,o;f&&(r=s(f),r.options.rules[t.name]=e={},r.options.messages[t.name]=o={},n.each(this.adapters,function(){var i="data-val-"+this.name,r=u.attr(i),s={};r!==undefined&&(i+="-",n.each(this.params,function(){s[this]=u.attr(i+this)}),this.adapt({element:t,form:f,message:r,params:s,rules:e,messages:o}))}),n.extend(e,{__dummy__:!0}),i||r.attachValidation())},parse:function(t){var i=n(t),u=i.parents().addBack().filter("form").add(i.find("form")).has("[data-val=true]");i.find("[data-val=true]").each(function(){r.unobtrusive.parseElement(this,!0)}),u.each(function(){var n=s(this);n&&n.attachValidation()})}},t=r.unobtrusive.adapters,t.add=function(n,t,i){return i||(i=t,t=[]),this.push({name:n,params:t,adapt:i}),this},t.addBool=function(n,t){return this.add(n,function(r){i(r,t||n,!0)})},t.addMinMax=function(n,t,r,u,f,e){return this.add(n,[f||"min",e||"max"],function(n){var f=n.params.min,e=n.params.max;f&&e?i(n,u,[f,e]):f?i(n,t,f):e&&i(n,r,e)})},t.addSingleVal=function(n,t,r){return this.add(n,[t||"val"],function(u){i(u,r||n,u.params[t])})},r.addMethod("__dummy__",function(){return!0}),r.addMethod("regex",function(n,t,i){var r;return this.optional(t)?!0:(r=new RegExp(i).exec(n),r&&r.index===0&&r[0].length===n.length)}),r.addMethod("nonalphamin",function(n,t,i){var r;return i&&(r=n.match(/\W/g),r=r&&r.length>=i),r}),r.methods.extension?(t.addSingleVal("accept","mimtype"),t.addSingleVal("extension","extension")):t.addSingleVal("extension","extension","accept"),t.addSingleVal("regex","pattern"),t.addBool("creditcard").addBool("date").addBool("digits").addBool("email").addBool("number").addBool("url"),t.addMinMax("length","minlength","maxlength","rangelength").addMinMax("range","min","max","range"),t.addMinMax("minlength","minlength").addMinMax("maxlength","minlength","maxlength"),t.add("equalto",["other"],function(t){var r=e(t.element.name),u=t.params.other,s=o(u,r),h=n(t.form).find(":input").filter("[name='"+f(s)+"']")[0];i(t,"equalTo",h)}),t.add("required",function(n){(n.element.tagName.toUpperCase()!=="INPUT"||n.element.type.toUpperCase()!=="CHECKBOX")&&i(n,"required",!0)}),t.add("remote",["url","type","additionalfields"],function(t){var r={url:t.params.url,type:t.params.type||"GET",data:{}},u=e(t.element.name);n.each(h(t.params.additionalfields||t.element.name),function(i,e){var s=o(e,u);r.data[s]=function(){var i=n(t.form).find(":input").filter("[name='"+f(s)+"']");return i.is(":checkbox")?i.filter(":checked").val()||i.filter(":hidden").val()||"":i.is(":radio")?i.filter(":checked").val()||"":i.val()}}),i(t,"remote",r)}),t.add("password",["min","nonalphamin","regex"],function(n){n.params.min&&i(n,"minlength",n.params.min),n.params.nonalphamin&&i(n,"nonalphamin",n.params.nonalphamin),n.params.regex&&i(n,"regex",n.params.regex)}),n(function(){r.unobtrusive.parse(document)})})(jQuery);var O365;(function(n){var t=function(){function n(){}return n.Initialize=function(t){var i=$("#"+t);i.off(n.OnClickEventName).on(n.OnClickEventName,function(t){n.ExecuteClickAction(i.data("client-click"),i.data("prevent-default"),t)});i.off(n.OnKeydownEventName).on(n.OnKeydownEventName,function(t){(t.which==13||t.which==32)&&n.ExecuteClickAction(i.data("client-click"),i.data("prevent-default"),t)})},n.SetClientClickData=function(n,t){var i=$("#"+n);i.data("client-click",t)},n.SetBeforeText=function(n,t){$("#"+n+"_before").text(t)},n.SetAfterText=function(n,t){$("#"+n+"_after").text(t)},n.SetLinkText=function(n,t){$("#"+n).text(t)},n.SetLinkHref=function(n,t){$("#"+n).attr("href",t)},n.GetLinkText=function(n){return $("#"+n).text()},n.GetBeforeText=function(n){return $("#"+n+"_before").text()},n.GetAfterText=function(n){return $("#"+n+"_after").text()},n.ExecuteClickAction=function(n,t,i){n!==undefined&&n!==""&&(Function(n)(),t&&i.preventDefault())},n.ParentSelector=".HyperLink",n.OnClickEventName="click.o365.common.ui.hyperlink.internal",n.OnKeydownEventName="keydown.o365.common.ui.hyperlink.internal",n}();n.HyperLink=t,$(t.ParentSelector).each(function(){t.Initialize($(this).attr("id"))})})(O365||(O365={}));var O365;(function(n){var t=function(){function n(){}return n.Initialize=function(t){var i=n.GetControlById(t),r=i.data("animate-on-post");if(r&&r.toLowerCase()==="true")$(window).on("unload",function(){var n=i.find("img");n.attr("src",n.attr("src"))})},n.SetText=function(t,i){var r=n.GetControlById(t),u=n.GetTextContainer(r);u.text(i)},n.GetControlById=function(n){return $("#"+n)},n.GetTextContainer=function(n){return n.find(".Loading-Horizontal-Text")},n}();n.Loading=t,$(".Loading-Horizontal").each(function(){t.Initialize($(this).attr("id"))})})(O365||(O365={}));var O365;(function(n){var t=function(){function n(){}return n.Initialize=function(t){var i="#"+t;$(document).on("click",i,function(){Function($(i).data("client-click"))()}).on("mousedown",i,function(){n.MouseDown(t)}).on("mouseup",i,function(){n.MouseUp(t)}).on("mouseover",i,function(){n.MouseOver(t)}).on("mouseout",i,function(){n.MouseOut(t)}).on("focus",i,function(){n.Focus(t)}).on("blur",i,function(){n.Blur(t)})},n.Enable=function(n){$("#"+n+"_disabled").hide(),$("#"+n).show()},n.Disable=function(n){$("#"+n+"_disabled").show(),$("#"+n).hide()},n.Show=function(n){$("#"+n+"_disabled").show(),$("#"+n).show()},n.Hide=function(n){$("#"+n+"_disabled").hide(),$("#"+n).hide()},n.SetText=function(n,t){$("#"+n+"_disabled span").html(t),$("#"+n+" span").html(t)},n.Click=function(n){$("#"+n).click()},n.IsEnabled=function(n){return $("#"+n).css('display')!='none'},n.SetEnabled=function(t,i){(i?n.Enable:n.Disable)(t)},n.IsPrimary=function(n){return $("#"+n).data('is-primary')==!0},n.ResizeButtons=function(){var t=0;$(".Button").each(function(){var r=$(this).attr("id"),i=n.GetWidth(r);return i>t&&(t=i),0}),$(".Button").width(t)},n.GetWidth=function(n){var r=0,i=$("#"+n),t;return i.css("width","auto"),i.css("display")=='none'||i.width()==0?(t=i.clone(!0),t.css("position","absolute"),t.css("left","-10000px"),t.css("display","inline-block"),$("body").append(t),r=t.width(),t.hide(),t.remove()):r=i.width(),r},n.MouseOver=function(t){n.ActiveButton==t?n.SetActiveState(t):n.SetHoverState(t)},n.MouseOut=function(t){n.FocusButton==t||n.FocusButton==null&&n.DefaultButton==t?n.SetFocusedState(t):n.SetRestState(t)},n.MouseDown=function(t){n.ActiveButton=t,n.SetActiveState(t)},n.MouseUp=function(){n.ActiveButton!=null&&(n.SetFocusedState(n.ActiveButton),n.ActiveButton=null)},n.Focus=function(t){n.FocusButton=t,n.ActiveButton==t?n.SetActiveState(t):n.SetFocusedState(t)},n.Blur=function(t){n.FocusButton=null,n.SetRestState(t),n.DefaultButton!=null&&n.DefaultButton!=''&&n.DefaultButton!=t&&n.SetFocusedState(n.DefaultButton)},n.AttachDefaultButtonHandlers=function(){var i,t;for(n.AddHandler(window.document.getElementsByTagName('a')),n.AddHandler(window.document.getElementsByTagName('textarea')),n.AddHandler(window.document.getElementsByTagName('select')),n.AddHandler(window.document.getElementsByTagName('input')),i=window.document.getElementsByTagName('form'),t=0;t<i.length;t++)$(i[t]).keypress(n.SuppressionDefaultKeyHandling)},n.AddHandler=function(t){for(var i=0;i<t.length;i++)$(t[i]).blur(n.OnBlurEnableDefaultButtonHandler),$(t[i]).focus(n.OnFocusDisableDefaultButtonHandler)},n.OnBlurEnableDefaultButtonHandler=function(){n.DefaultButton!=null&&n.DefaultButton!=''&&n.SetFocusedState(n.DefaultButton)},n.OnFocusDisableDefaultButtonHandler=function(t){t.target.getAttribute('data-ignoreDefaultButton')==='true'||t.target.tagName.toLowerCase()!='input'?n.DefaultButton!=null&&n.DefaultButton!=t.target.id&&n.SetRestState(n.DefaultButton):n.SetFocusedState(n.DefaultButton)},n.DefaultButtonKeyDownHandler=function(t){var u=t.target||t.srcElement,i=u.tagName,r=u.getAttribute('data-ignoreDefaultButton');return(t.charCode==13||t.keyCode==13)&&n.DefaultButton!=null&&n.DefaultButton!=''&&i.toUpperCase()!='A'&&i.toUpperCase()!='TEXTAREA'&&i.toUpperCase()!='SELECT'&&(!r||r&&r!=='true')&&(n.ActivatedButtonID=n.DefaultButton),(t.charCode==27||t.keyCode==27)&&n.CancelButton!=null&&n.CancelButton!=''&&i.toUpperCase()!='SELECT'&&(n.ActivatedButtonID=n.CancelButton),!0},n.DefaultButtonKeyUpHandler=function(){if(n.ActivatedButtonID!=null){var i=document.getElementById(n.ActivatedButtonID);n.ActivatedButtonID=null,i!=null&&i.style.display.toLowerCase()!='none'&&n.Click(i.id)}return!0},n.SuppressionDefaultKeyHandling=function(t){return n.ActivatedButtonID!=null?(t.preventDefault?t.preventDefault():(t.keyCode=0,t.cancelBubble=!0,t.returnValue=!1),!1):!0},n.SetDefaultButton=function(t){n.DefaultButton!=null&&n.DefaultButton!=''&&n.SetRestState(n.DefaultButton),n.DefaultButton=t,n.SetFocusedState(t)},n.SetCancelButton=function(t){n.CancelButton=t},n.SetRestState=function(t){n.SetCssClass(t,'')},n.SetHoverState=function(t){n.SetCssClass(t,'hover')},n.SetActiveState=function(t){n.SetCssClass(t,'active')},n.SetFocusedState=function(t){n.SetCssClass(t,'focus')},n.SetCssClass=function(t,i){var u=$("#"+t),r=i,f=n.IsPrimary(t);if(u.length!=0){if(i==null||i=='')r="Button",r=r+(f?" ms-fcl-w ms-bgc-tp ms-bcl-tp":" ms-fcl-np ms-bgc-nlr ms-bcl-tt");else{r="Button-"+i;switch(i){case"hover":r=r+" ms-fcl-nd ms-bgc-tl ms-bcl-tt";break;case"active":r=r+" ms-fcl-tt ms-bgc-tp ms-bcl-tp";break;case"focus":r=r+" ms-fcl-w ms-bgc-tp ms-bcl-tp"}}u.removeClass("ms-fcl-np").removeClass("ms-bgc-nlr").removeClass("ms-bcl-tt").removeClass("Button-hover").removeClass("ms-fcl-nd").removeClass("ms-bgc-tl").removeClass("ms-bcl-tt").removeClass("Button-active").removeClass("ms-fcl-tt").removeClass("ms-bgc-tp").removeClass("ms-bcl-tp").removeClass("Button-focus").removeClass("ms-fcl-w ").removeClass("ms-bgc-tp").removeClass("ms-bcl-tp").addClass(r)}},n}();n.Button=t,$&&($(".Button").each(function(){t.Initialize($(this).attr("id"))}),$(window.document.documentElement).keyup(t.DefaultButtonKeyUpHandler).keydown(t.DefaultButtonKeyDownHandler),t.AttachDefaultButtonHandlers())})(O365||(O365={}));var O365;(function(n){var t=function(){function n(){}return n.ShowCallout=function(n){var t=$("#"+n),r,i,u,f;if(t.length!==0&&(r=$("#"+t.data("target-id")),i=t.data("position"),i)){t.show(),u=r.offset().top,f=r.offset().left;switch(t.data("position")){case"Top":i={top:u-t.outerHeight(),left:f};break;case"Left":i={top:u,left:f-t.outerWidth()};break;case"Bottom":i={top:u+r.outerHeight(),left:f};break;case"Right":i={top:u,left:f+r.outerWidth()}}t.offset(i)}},n.HideCallout=function(n){var t=$("#"+n);t.hide()},n.Initialize=function(t){var i=$("#"+t),o,r,u;if(i){var f=i.data('foreground-class'),e=i.data('background-class'),s=i.data('border-class'),h=i.find('.'+n.BfPlaceholderClassName);h.removeClass(n.BfPlaceholderClassName).addClass(f).addClass(e),o=i.find('.'+n.BfbPlaceholderClassName),o.removeClass(n.BfbPlaceholderClassName).addClass(f).addClass(e).addClass(s)}r=i.data("target-id"),r&&(r=$("#"+r),r.attr("aria-describedby",t+"_ErrorMessage"),r.attr("aria-haspopup","true")),i.data("validator")||(r.mouseenter(function(){u&&clearTimeout(u),n.ShowCallout(t)}).focus(function(){n.ShowCallout(t)}).mouseleave(function(){u=window.setTimeout(function(){n.HideCallout(t)},1e3)}).blur(function(){n.HideCallout(t)}),i.mouseenter(function(){u&&clearTimeout(u)}).mouseleave(function(){n.HideCallout(t)}))},n.BfPlaceholderClassName="bf-placeholder",n.BfbPlaceholderClassName="bfb-placeholder",n}();n.HelpCallout=t,$(".HelpCallout").each(function(n,i){t.Initialize($(i).attr("id"))})})(O365||(O365={}));var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i),t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),O365,oldShow;(function(n){var i=function(i){function r(){return i!==null&&i.apply(this,arguments)||this}return __extends(r,i),r.Initialize=function(t){var r=$("#"+t),i;r.data("validator")&&(i=r.data("target-id"),n.Validators.ActiveValidators.push(new n.Validator(i,i+"Callout")))},r.InitializeAll=function(){$("[data-validator='true']").each(function(n,t){r.Initialize($(t).attr("id"))})},r.HideCallout=function(i){n.HelpCallout.HideCallout(i);var r=t.GetByCallout(i);n.Validators.VisibleHelpCalloutId=null},r.ShowCallout=function(i){$(".HelpCallout").each(function(){var n=$(this);return n.data("validator")&&r.HideCallout($(this).attr('id')),null}),n.HelpCallout.ShowCallout(i);var u=t.GetByCallout(i);n.Validators.VisibleHelpCalloutId=i},r.TargetBorderClassData="validator-target-border-class",r}(n.HelpCallout),t,r;n.ValidatorCallout=i,t=function(){function n(){}return n.GetByElement=function(t){for(var i=0;i<n.ActiveValidators.length;i++)if(n.ActiveValidators[i].ElementId===t)return n.ActiveValidators[i];return null},n.GetByCallout=function(t){for(var i=0;i<n.ActiveValidators.length;i++)if(n.ActiveValidators[i].HelpCalloutId===t)return n.ActiveValidators[i];return null},n.ActiveValidators=[],n.VisibleHelpCalloutId=null,n}(),n.Validators=t,r=function(){function n(n,t){this.ElementId=n,this.HelpCalloutId=t}return n}(),n.Validator=r,i.InitializeAll()})(O365||(O365={})),oldShow=$.validator.prototype.showLabel,$.validator.prototype.showLabel=function(n,t){var i=O365.Validators.GetByElement($(n).attr('id')),r,u;if(i)if(r=$("#"+i.ElementId),u=$("#"+i.HelpCalloutId).data(O365.ValidatorCallout.TargetBorderClassData),t){null===O365.Validators.VisibleHelpCalloutId&&O365.ValidatorCallout.ShowCallout(i.HelpCalloutId);r.on("blur.validator",function(){O365.ValidatorCallout.HideCallout(i.HelpCalloutId)}).on("focus.validator",function(){$(this).hasClass("validator")&&O365.ValidatorCallout.ShowCallout(i.HelpCalloutId)});$("#"+i.ElementId).addClass(u)}else O365.Validators.VisibleHelpCalloutId===i.HelpCalloutId&&(O365.ValidatorCallout.HideCallout(i.HelpCalloutId),r.off("blur.validator").off("focus.validator")),$("#"+i.ElementId).removeClass(u);(i&&i.Message!=t||!i)&&(i&&(i.Message=t),oldShow.call(this,n,t))};var O365;(function(n){var r=function(){function n(){}return n}(),t,i;n.MultiPageLayoutSettings=r,t=function(){function t(){}return t.Initialize=function(){},t.InitializePanel=function(n){var i=$("#"+n),r=t.ContainerToPanel(i),u=t.CreateMultiPagePanel(r,n);t.panels.push(u),i.hide()},t.InitializeLayout=function(n){t.settings=n,t.activeStepIndex=n.InitialStepIndex,t.activePanelIndex=n.InitialPanelIndex,t.ApplyGeminiStyles(t.GetParent()),t.ShowActivePanel()},t.InsertAndShowNewPanel=function(i){var a=t.ValidatePanel(i),c,l,f,e;if(!a)return!1;var o=!0,s=1,r=$(i),u=r[0].id,h=$("#"+u);if(h.length===0?($(".mpl-content-box").append(r),t.UpdatePanelsArray(u)):(h.replaceWith(r),c=t.GetPanelsIndexFromContainer(r),s=c-t.activePanelIndex,l=t.ReplaceInPanelsArray(u),o=!l.some(function(n){return n===t.activePanelIndex})),r=$("#"+u),r.find(n.HyperLink.ParentSelector).each(function(){n.HyperLink.Initialize($(this).attr("id"))}),r.find(".HelpCallout").each(function(){n.HelpCallout.Initialize($(this).attr("id"))}),t.HookupValidators(r),f=t.ContainerToPanelObject(r),f.FormId){e=$("#"+f.FormId);e.off(t.OnKeydownEvent).on(t.OnKeydownEvent,function(n){var i=n.srcElement?n.srcElement:n.target;n.which==13&&$(i).is('input')&&(t.OnNext(),n.preventDefault())});e.off(t.OnInvalidFormEvent).on(t.OnInvalidFormEvent,function(){t.OperationCancelled()})}return o?t.Next(s):t.ShowActivePanel(),!0},t.Next=function(n){var i,r;if(n===void 0&&(n=1),i=t.activePanelIndex+n,i<0||i>=t.panels.length){console.error("New panel index: %i is outside the bounds of MultiPageLayout.panels array of length: %i",i,t.panels.length);throw new Error("Array index out of bounds.");}r=t.GetActivePanel(),$("#"+r.ContainerID).hide(),t.activePanelIndex=i,t.backForwardStack.push(n),t.ShowActivePanel(),t.AdvanceStepIfNecessary()},t.Prev=function(n){var i,r;n===void 0&&(n=null),t.activePanelIndex!==0&&(i=t.panels[t.activePanelIndex],$("#"+i.ContainerID).hide(),r=t.backForwardStack.pop()||1,t.activePanelIndex=t.activePanelIndex-r,t.ShowActivePanel(n))},t.SubmitActivePanelForm=function(n){n===void 0&&(n=""),t.StartOperation(n);var r=t.GetActivePanel(),i=$("#"+r.FormId);i.find("input[name='AjaxSessionKey']").attr('value',Microsoft.Online.BOX.JS.Shared.GetSessionCookie('AjaxSessionKey')),i.submit()},t.UpdateOptionalDescription=function(n){t.UpdateOptionalText("#MultiPageLayout_OptionalBox > span:first-child",n)},t.UpdateOptionalActionText=function(n){t.UpdateOptionalText("#MultiPageLayout_OptionalBox > a",n)},t.UpdateOptionalActionTextAriaLabel=function(n){t.UpdateOptionalTextAriaLabel("#MultiPageLayout_OptionalBox > a",n)},t.ShowBanner=function(){var n=t.GetParent().find('.mpl-banner-box');n.show()},t.HideSteps=function(){var n=$('[class^="mpl-step-"]');n.addClass(t.stepInvisibleClass)},t.HideStepsBox=function(){var n=$('.mpl-steps-box');n.addClass(t.stepsBoxInvisibleClass)},t.ShowSteps=function(){var n=$('[class^="mpl-step-"]');n.removeClass(t.stepInvisibleClass)},t.ShowStepsBox=function(){var n=$('.mpl-steps-box');n.removeClass(t.stepsBoxInvisibleClass)},t.HideActionButtons=function(){$(".mpl-buttons-box").hide()},t.ShowActionButtons=function(){$(".mpl-buttons-box").show()},t.HideOptionalAction=function(){$("#MultiPageLayout_OptionalBox").children().hide()},t.ShowOptionalAction=function(){$("#MultiPageLayout_OptionalBox").children().show()},t.MakeFirstPanelActive=function(){t.activePanelIndex>=0&&t.ShowActivePanel()},t.MakePanelActive=function(n){var i=t.GetPanelsIndexFromContainerId(n),r;return i<0?!1:(r=t.GetActivePanel(),$("#"+r.ContainerID).hide(),t.activePanelIndex=i,t.ShowActivePanel(),!0)},t.RemovePanel=function(n){var i=t.GetPanelsIndexFromContainerId(n),r;return i<0?!1:(r=t.panels[i],$("#"+r.ContainerID).remove(),t.panels.splice(i,1),!0)},t.OperationCancelled=function(){t.EndOperation()},t.StartOperation=function(i){i===void 0&&(i=""),t.HideActionButtons();var r=t.GetActivePanel(),u=t.GetParent().data('progress-text');i=i||r.ProgressText||u,n.Loading.SetText('MultiPageLayout_Loading',i),$("#MultiPageLayout_Loading").show()},t.EndOperation=function(){$("#MultiPageLayout_Loading").hide(),t.ShowActionButtons()},t.GetActivePanelProgressText=function(){var n=t.GetActivePanel();return n.ProgressText},t.HookupValidators=function(i){var u=t.GetPanelsIndexFromContainer(i),f=t.panels[u],r=$('#'+f.FormId);r.length>0&&(r.removeData('validator').removeData('unobtrusiveValidation'),$.validator.unobtrusive.parse("#"+r.attr("id")),n.ValidatorCallout.InitializeAll(),r.find('.field-validation-error').attr("role","alert"))},t.OnNext=function(){var n=t.GetActivePanel(),i=n.OnNextAction;i?Function(i)():n.FormId?t.SubmitActivePanelForm():t.Next()},t.OnPrev=function(){var i=t.GetActivePanel(),n=i.OnBackAction;n?Function(n)():t.Prev()},t.OnAdditional=function(){var n=t.GetActivePanel(),i=n.OnOptionalAction;i&&(n.DontShowProgressOnOptionalAction||t.StartOperation(),Function(n.OnOptionalAction)())},t.OnJumpStep=function(n){var i=t.GetParent();i.trigger(t.OnStepClickEvent,[n])},t.OnCancel=function(){var n=t.GetParent().data("cancel-click");n&&Function(n)()},t.SetTitle=function(n){var i=t.GetParent().find(".mpl-title-box-text");i.text(n)},t.SetBannerText=function(n){var i=t.GetParent(),r=i.find(".mpl-banner-box-text");r.text(n),t.ShowBanner()},t.PeekNextPanel=function(){return t.activePanelIndex<t.panels.length?t.panels[t.activePanelIndex+1]:null},t.GetActivePanel=function(){return t.panels[t.activePanelIndex]},t.DisableStepClicking=function(){$(".mpl-step").each(function(n,i){var u=t.GetStepActionSpan($(i)),r;u.addClass(t.stepActionHiddenClass),r=t.GetStepLabelSpan($(i)),r.removeClass(t.stepActionHiddenClass)})},t.ShowActivePanel=function(i){var r,u,f,e;return i===void 0&&(i=null),r=t.GetActivePanel(),t.UpdateLinkText("#MultiPageLayout_Next",r.NextActionText,"next-text"),t.UpdateLinkText("#MultiPageLayout_Prev",r.BackActionText,"back-text"),t.UpdateOptionalDescription(r.OptionalActionDescription),t.UpdateOptionalActionText(r.OptionalActionText),t.UpdateOptionalActionTextAriaLabel(r.OptionalActionTextAriaLabel),t.SetTitle(r.Title),r.BannerText&&t.SetBannerText(r.BannerText),r.BackActionText&&(r.OnBackAction||!t.AtFirstPanelOfStep())?(n.Button.Show("MultiPageLayout_Prev"),n.Button.Enable("MultiPageLayout_Prev")):(n.Button.Disable("MultiPageLayout_Prev"),n.Button.Hide("MultiPageLayout_Prev")),t.EndOperation(),u=$("#"+r.ContainerID),f=t.ContainerToPanel(u),t.ExecuteOnShowAction(f,i),t.ShowValidators(f),t.ApplyGeminiStyles(f),u.show(),e=$('*[role="alert"]:visible'),e.each(function(n,t){$(t).hide(),$(t).show()}),!t.settings.DontSetFocus&&$("input[type='text']",u).length>0&&$("input[type='text']",u)[0].focus(),r},t.ShowValidators=function(t){t.find('[data-validator="true"]').each(function(){var r=$(this);return $("#"+r.data("target-id")).hasClass("input-validation-error")&&n.ValidatorCallout.ShowCallout(r.attr("id")),this})},t.ApplyGeminiStyles=function(n){t.settings.EnableGeminiStyle==!0&&n.addClass(t.geminiClass).find('[class*="mpl-"]').addClass(t.geminiClass)},t.UpdateClickHandler=function(n,t,i){$(n).off("click").click(function(){Function(t?t:i)()})},t.UpdateLinkText=function(n,i,r){var u=t.GetParent();i?$(n+" .mpl-button-box-text").text(i):$(n+" .mpl-button-box-text").text(u.data(r))},t.UpdateOptionalText=function(n,t){t?$(n).text(t).show():$(n).hide()},t.UpdateOptionalTextAriaLabel=function(n,t){t?$(n).attr("aria-label",t):$(n).removeAttr("aria-label")},t.ValidatePanel=function(n){var i=$(n),r,u,f;return i.length===0?!1:(r=i[0].id,!r)?!1:(u=t.ContainerToPanel(i),u.length===0)?!1:(f=t.CreateMultiPagePanel(u,r),typeof f.PanelID=='undefined'||typeof f.StepIndex=='undefined')?!1:!0},t.CreateMultiPagePanel=function(n,t,r){r===void 0&&(r=null);var u=new i;return u.ContainerID=t,u.PanelID=n[0].id,u.FormId=n.data("form-id"),u.StepIndex=n.data('step-index'),u.NextActionText=n.data("next-text"),u.BackActionText=n.data("back-text"),u.ProgressText=n.data("progress-text"),u.BannerText=n.data("banner-text"),u.OptionalActionText=n.data("optional-text"),u.OptionalActionTextAriaLabel=n.data("optional-text-label"),u.OptionalActionDescription=n.data("optional-description"),u.OnNextAction=n.data("next-click"),u.OnBackAction=n.data("back-click"),u.OnOptionalAction=n.data("optional-click"),u.DontShowProgressOnOptionalAction=/^true$/i.test(n.data("dont-show-progress-on-optional-click")),u.Title=n.data("title-text"),u},t.UpdatePanelsArray=function(n){var i=$("#"+n),r=t.ContainerToPanel(i),u=t.CreateMultiPagePanel(r,n);t.panels.splice(t.activePanelIndex+1,0,u)},t.ReplaceInPanelsArray=function(n){var i=[];return i.push(t.ReplaceExistingPanel(n)),i},t.ReplaceExistingPanel=function(n){var i=t.GetPanelsIndexFromContainerId(n);if(i===-1)t.UpdatePanelsArray(n);else{var r=$("#"+n),u=t.ContainerToPanel(r),f=t.panels[i],e=t.CreateMultiPagePanel(u,n,f);t.panels[i]=e}return i},t.GetPanelsIndexFromContainer=function(n){return t.GetPanelsIndexFromContainerId(n[0].id)},t.GetPanelsIndexFromContainerId=function(n){for(var i=0;i<t.panels.length;i++)if(t.panels[i].ContainerID===n)return i;return-1},t.ContainerToPanelId=function(n){var i=t.ContainerToPanel(n);return i[0].id},t.ContainerToPanel=function(n){return n.hasClass("MultiPageLayoutPanel")?n:n.find(".MultiPageLayoutPanel").first()},t.ContainerToPanelObject=function(n){var i=t.GetPanelsIndexFromContainer(n);if(i!==-1)return t.panels[i]},t.AdvanceStepIfNecessary=function(){for(var n=t.panels[t.activePanelIndex],u=t.GetStepItem(n.StepIndex),f,r,i=0;i<n.StepIndex;i++)f=t.GetStepItem(i),t.MarkStepCompleted(f);n.StepIndex>t.activeStepIndex&&!t.IsStepCompleted(u)&&t.MarkStepInProgress(u),r=undefined,t.panels.length>t.activePanelIndex+1&&(r=t.panels[t.activePanelIndex+1]),r&&r.StepIndex==n.StepIndex||t.MarkStepCompleted(u),t.activeStepIndex=n.StepIndex},t.GetStepItem=function(n){var t=$('.mpl-steps-box > ul');return $('li:nth-child('+(n+1)+')',t)},t.GetStepIconElement=function(n){return $('.mpl-step-icon',n)},t.GetStepIndex=function(n){return n.data("stepindex")},t.GetStepActionSpan=function(n){return $('.mpl-step-action',n)},t.GetStepLabelSpan=function(n){return $('.mpl-step-label',n)},t.MarkStepCompleted=function(n){var i=t.GetStepIconElement(n),r=t.GetStepIndex(n);i.removeClass(t.inProgressIconClass).addClass(t.completedIconClass).attr("aria-label",String.format(t.settings.StepCompletedAriaLabel,r+1))},t.IsStepCompleted=function(n){var i=t.GetStepIconElement(n);return i.hasClass(t.completedIconClass)},t.MarkStepInProgress=function(n){var u=t.GetStepIconElement(n),f=t.GetStepIndex(n),i,r;u.removeClass(t.notStartedIconClass).addClass(t.inProgressIconClass).attr("aria-label",String.format(t.settings.StepInProgressAriaLabel,f+1)),i=t.GetStepActionSpan(n),i.removeClass(t.stepActionHiddenClass),r=t.GetStepLabelSpan(n),r.addClass(t.stepActionHiddenClass)},t.AtFirstPanelOfStep=function(){var i=t.GetActivePanel(),n=t.PeekPreviousPanel();return n?n.StepIndex!=i.StepIndex:!0},t.ExecuteOnShowAction=function(n,t){t===void 0&&(t=null);var i=n.data("onshow-action");i&&Function(i)(t)},t.PeekPreviousPanel=function(){return t.activePanelIndex>0?t.panels[t.activePanelIndex-1]:null},t.GetOverrideThemeBackgroundColorStyle=function(){var n=t.GetParent().data('override-theme-background-color');return n!=''?'background-color: '+n:''},t.GetParent=function(){return $('.mpl-layout')},t.OnStepClickEvent="stepclick.o365.common.ui.multipagelayout",t.ParentClass=".mpl-layout",t.OnInvalidFormEvent="invalid-form.o365.common.ui.multipagelayout.internal",t.OnKeydownEvent="keydown.o365.common.ui.multipagelayout.internal",t.panels=[],t.activePanelIndex=-1,t.activeStepIndex=-1,t.geminiClass="gemini",t.inProgressIconClass="ms-bgc-tp mpl-step-state-inprogress",t.notStartedIconClass="ms-bgc-nta mpl-step-state-notstarted",t.completedIconClass="ms-bgc-nta wf-portal-check mpl-step-state-completed",t.stepActionHiddenClass="mpl-step-action-hidden",t.stepInvisibleClass="mpl-step-invisible",t.stepsBoxInvisibleClass="mpl-stepsbox-invisible",t.backForwardStack=[],t}(),n.MultiPageLayout=t,i=function(){function n(){}return n}(),n.MultiPagePanel=i,t.Initialize()})(O365||(O365={}));var O365;(function(n){var t=function(){function n(){}return n.ToggleHelpInfo=function(t){n.onToggle($("#"+t))},n.ToggleHelpInfoOnKey=function(t,i){var r=$("#"+t),u=i.keyCode?i.keyCode:i.which;if(u==32)n.onToggle(r)},n.onToggle=function(t){t.toggle();var i=t.parent();i.length!==0&&(t.is(':visible')?i.addClass('hideFocus'):(i.removeClass('hideFocus'),i.focus()),i.trigger(n.OnToggleEventName))},n.Initialize=function(t){var i=$("#"+t),r;t.lastIndexOf("_Remote")==t.length-7&&(i=$("#"+t.replace("Title_","").replace("_Remote",""))),r="Info_"+t,i.length!==0&&i.click(function(){n.ToggleHelpInfo(r)}).keypress(function(t){n.ToggleHelpInfoOnKey(r,t)})},n.OnToggleEventName='toggle.o365.common.ui.whatsthis',n}();n.WhatsThis=t,$(".help-text").each(function(n,i){t.Initialize($(i).attr("id"))})})(O365||(O365={}));